#!/bin/bash
# Update all packages
sudo yum update -y

# Install Amazon Corretto JRE (headless version for servers)
sudo yum install -y java-17-amazon-corretto-headless

# Verify installation and log versions
mkdir -p /home/ec2-user/java_runtime_info
{
  echo "Java version:"
  java -version 2>&1 | head -n 1
} > /home/ec2-user/java_runtime_info/jre_version.txt

# Set JAVA_HOME for consistency
echo "export JAVA_HOME=$(dirname $(dirname $(readlink $(which java))))" | sudo tee -a /etc/profile
echo "export PATH=\$JAVA_HOME/bin:\$PATH" | sudo tee -a /etc/profile
source /etc/profile

# Ensure ec2-user owns the folder
chown -R ec2-user:ec2-user /home/ec2-user/java_runtime_info
